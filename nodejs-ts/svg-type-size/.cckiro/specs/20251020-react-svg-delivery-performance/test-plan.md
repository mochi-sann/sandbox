---
title: test-plan
spec: 20251020-react-svg-delivery-performance
status: draft
phase: implementation-planning
---

## テスト戦略

- ユニットテスト: SVG ローダー、レンダラーコンポーネント、設定管理の単体検証。
- 結合テスト: `npm run measure` コマンドでのビルド〜レポート生成フロー。
- 非機能テスト: 再現性 (R-006)、セキュリティ依存チェック (R-007)、ログ出力 (R-008)。

## テストケース一覧

- **T-001 (R-001, D-001, I-001)**: SVG ディレクトリ認識テスト
  - 種別: ユニット
  - 手順: テスト用 SVG を `assets/svg-samples/test.svg` に追加し `import.meta.glob` の戻り値を確認。
  - 期待結果: 追加した SVG がリストに含まれる。

- **T-002 (R-002, D-002, I-002)**: レンダラー表示確認
  - 種別: 結合 (React Testing Library)
  - 手順: `/benchmark` ページをレンダリングし、3 手法のセクションが存在し、`n` 枚の要素が表示されるか検証。
  - 期待結果: 各手法カードに SVG が `n` 個描画され、エラーが発生しない。

- **T-003 (R-003, D-003, I-003)**: レンダリング回数変更テスト
  - 種別: ユニット + 結合
  - 手順: `RENDER_COUNT` を 20 に設定してビルドし、UI の入力で 30 を設定後、URL クエリを検証。
  - 期待結果: ビルド成果物/レポートが指定値に基づき更新され、UI も同期する。

- **T-004 (R-004, D-004, I-004)**: サイズ測定スクリプト
  - 種別: 結合（CLI）
  - 手順: `npm run measure` を実行し、`reports/latest/size-summary.json` の存在と内容を確認。
  - 期待結果: 手法ごとのサイズ情報が JSON に記録され、CLI にも出力される。

- **T-005 (R-005, D-005, I-005)**: レポート UI / エクスポート
  - 種別: 結合 (E2E: Playwright)
  - 手順: `BenchmarkReport.tsx` を表示し、表と CSV/JSON ダウンロードが機能するか検証。
  - 期待結果: ボタン押下でファイルが生成され、差分が正しく表示される。

- **T-006 (R-006, D-006, I-006)**: 再現性チェック
  - 種別: 非機能（性能）
  - 手順: 同一条件で `npm run measure` を 3 回実行し、`reports/history` の差異を比較。
  - 期待結果: ぶれが 1% 未満で警告なし。超過時は `anomaly.json` が出力される。

- **T-007 (R-007, D-007, I-007)**: セキュリティ/依存検証
  - 種別: 非機能（セキュリティ）
  - 手順: `npm audit --production` を実行。
  - 期待結果: 重大/高リスクの脆弱性が検出されない。

- **T-008 (R-008, D-008, I-008)**: 観測ログ検証
  - 種別: 非機能（可観測性）
  - 手順: 測定後の `reports/history` と `logs/benchmark.log` を確認。
  - 期待結果: 測定パラメータと結果メタデータが記録され、欠落がない。
